# Python3 关键字nonlocal和global的用法与区别

## 关键字nonlocal

在Python 2.x中，闭包只能读外部函数的变量，而不能改写它。为了解决这个问题，Python 3.x引入了nonlocal关键字，在闭包内用nonlocal声明变量，就可以让解释器在外层函数中查找变量名。

注意：关键字nonlocal:是python3.X中出现的,所以在python2.x中无法直接使用.

## 关键字global

Python里只有2种作用域：全局作用域和局部作用域。全局作用域是指当前代码所在模块的作用域，局部作用域是指当前函数或方法所在的作用域。局部作用域里的代码可以读外部作用域（包括全局作用域）里的变量，但不能更改它。如果想更改它，这里就要使用global关键字了

## 实例

关键字nonlocal的作用与关键字global类似，使用nonlocal关键字可以在一个嵌套的函数中修改嵌套作用域中的变量。但是global和nonlocal是用在不同的情况中。

看两个例子:

```python
name = 'pythontab'
def func()
    global name
    name = 'pythontab.com'
func()
print(name)

输出：
pythontab.com
```

name没有在func的入参中，所以没有global修饰，func中的局部变量name无法被识别为全局变量name，从而被修改。

```python
def func():
    name = 'pythontab'
    def foo():
        nonlocal name
        name = 'pythontab.com'
    foo()
    print(name)
func()


输出：
pythontab.com
```

name没有在foo的入参中，所以没有nonlocal修饰，func中的局部变量name无法被识别为上一级函数中的局部变量name，从而被修改。



## 总结

主要区别有以下两点：

1.两者的功能不同。

- global关键字修饰变量后标识该变量是全局变量，对该变量进行修改就是修改全局变量
- nonlocal关键字修饰变量后标识该变量是上一级函数中的局部变量，如果上一级函数中不存在该局部变量，nonlocal位置会发生错误（最上层的函数使用nonlocal修饰变量必定会报错）。

2.两者使用的范围不同。

- global关键字可以用在**任何地**方，包括最上层函数中和嵌套函数中，**即使之前未定义该变量**，global修饰后也可以直接使用
- **nonlocal关键字只能用于嵌套函数中**，**并且外层函数中定义了相应的局部变量**，否则会发生错误。



























